<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SportSync AI - MCP Server Test Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .status-healthy {
            background: #10b981;
            color: white;
        }

        .status-error {
            background: #ef4444;
            color: white;
        }

        .endpoint-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .endpoint-card {
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .endpoint-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .endpoint-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .test-section {
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #374151;
        }

        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            min-height: 150px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
            margin-right: 10px;
        }

        .response-box {
            margin-top: 20px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .response-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .architecture {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .ai-card {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            text-align: center;
        }

        .ai-card h3 {
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feature-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– SportSync AI - MCP Server</h1>
            <p>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¨Ø­Ø« Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</p>
        </div>

        <!-- Server Status -->
        <div class="card">
            <h2>ğŸ”Œ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Ø¯Ù…</h2>
            <div id="serverStatus">
                <div class="loading">
                    <div class="spinner"></div>
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Ø¯Ù…...
                </div>
            </div>
        </div>

        <!-- Architecture -->
        <div class="card">
            <h2>ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            <div class="architecture">
                <div class="ai-card">
                    <h3>ğŸ§ </h3>
                    <h4>Reasoning AI</h4>
                    <p>o1-preview</p>
                    <small>ØªØ­Ù„ÙŠÙ„ Ù†ÙØ³ÙŠ Ø¹Ù…ÙŠÙ‚</small>
                </div>
                <div class="ai-card">
                    <h3>ğŸ¨</h3>
                    <h4>Intelligence AI</h4>
                    <p>GPT-4</p>
                    <small>ØªÙˆÙ„ÙŠØ¯ Ø±ÙŠØ§Ø¶Ø§Øª ÙØ±ÙŠØ¯Ø©</small>
                </div>
                <div class="ai-card">
                    <h3>ğŸ”</h3>
                    <h4>Research Engine</h4>
                    <p>Internet</p>
                    <small>Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</small>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="card">
            <h2>ğŸ“¡ Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
            <div class="endpoint-grid">
                <div class="endpoint-card" onclick="testEndpoint('/mcp/health')">
                    <h3>âœ… Health Check</h3>
                    <p>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø®Ø§Ø¯Ù…</p>
                </div>
                <div class="endpoint-card" onclick="testEndpoint('/mcp/capabilities')">
                    <h3>ğŸ¯ Capabilities</h3>
                    <p>Ù‚Ø¯Ø±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                </div>
                <div class="endpoint-card" onclick="showAnalyzeForm()">
                    <h3>ğŸ”¬ Analyze</h3>
                    <p>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ø®ØµÙŠØ©</p>
                </div>
                <div class="endpoint-card" onclick="testResearch()">
                    <h3>ğŸŒ Research Test</h3>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø«</p>
                </div>
            </div>
        </div>

        <!-- Test Analysis Form -->
        <div class="card" id="analyzeForm" style="display: none;">
            <h2>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø¹ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</h2>
            <div class="test-section">
                <div class="form-group">
                    <label>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (JSON):</label>
                    <textarea id="testData">{
  "session_id": "test_123",
  "language": "ar",
  "answers": [
    {
      "question_key": "q1",
      "answer_text": "ÙÙŠ Ù„Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ø±Ø¹Ø© ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±"
    }
  ]
}</textarea>
                </div>
                <button class="btn btn-primary" onclick="runAnalysis()">ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„</button>
                <button class="btn btn-secondary" onclick="hideAnalyzeForm()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <!-- Response Display -->
        <div class="card" id="responseCard" style="display: none;">
            <h2>ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©</h2>
            <div class="response-box">
                <pre id="responseContent"></pre>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8000';

        // Check server status on load
        window.onload = async () => {
            await checkServerStatus();
        };

        async function checkServerStatus() {
            try {
                const response = await fetch(`${API_URL}/mcp/health`);
                const data = await response.json();

                document.getElementById('serverStatus').innerHTML = `
                    <span class="status-badge status-healthy">âœ… Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„</span>
                    <div style="margin-top: 15px;">
                        <strong>Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„:</strong> ${data.protocol}<br>
                        <strong>Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©:</strong> ${data.active_connections}<br>
                        <strong>Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ:</strong>
                        <ul class="feature-list">
                            <li>ğŸ§  ${data.services.reasoning_ai}</li>
                            <li>ğŸ¨ ${data.services.intelligence_ai}</li>
                        </ul>
                    </div>
                `;
            } catch (error) {
                document.getElementById('serverStatus').innerHTML = `
                    <span class="status-badge status-error">âŒ Ø§Ù„Ø®Ø§Ø¯Ù… ØºÙŠØ± Ù…ØªØµÙ„</span>
                    <p style="color: #ef4444; margin-top: 10px;">ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…: python3 mcp_server.py</p>
                `;
            }
        }

        async function testEndpoint(endpoint) {
            showResponse('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');

            try {
                const response = await fetch(`${API_URL}${endpoint}`);
                const data = await response.json();
                showResponse(JSON.stringify(data, null, 2));
            } catch (error) {
                showResponse(`Ø®Ø·Ø£: ${error.message}`, true);
            }
        }

        function showAnalyzeForm() {
            document.getElementById('analyzeForm').style.display = 'block';
            document.getElementById('analyzeForm').scrollIntoView({ behavior: 'smooth' });
        }

        function hideAnalyzeForm() {
            document.getElementById('analyzeForm').style.display = 'none';
        }

        async function runAnalysis() {
            const testData = document.getElementById('testData').value;

            try {
                const data = JSON.parse(testData);
                showResponse('ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª...\n\nÙ‡Ø°Ø§ Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ 10-20 Ø«Ø§Ù†ÙŠØ©...');

                const response = await fetch(`${API_URL}/mcp/analyze`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.status === 'NEEDS_MORE_DATA') {
                    showResponse(`ğŸ“ ÙŠØ­ØªØ§Ø¬ Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!\n\n` +
                                `Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${result.partial_research.sources_found}\n` +
                                `Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©: ${result.partial_research.sports_identified}\n\n` +
                                `Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©:\n\n` +
                                JSON.stringify(result.follow_up_questions, null, 2));
                } else {
                    showResponse(`âœ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„:\n\n` +
                                `Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ù…Ø³ØªØ´Ø§Ø±Ø©: ${result.data.research_summary.total_sources}\n` +
                                `Ø§Ù„Ø«Ù‚Ø©: ${result.data.research_summary.confidence}\n\n` +
                                JSON.stringify(result, null, 2));
                }
            } catch (error) {
                showResponse(`Ø®Ø·Ø£: ${error.message}`, true);
            }
        }

        async function testResearch() {
            showResponse('ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø«...\n\nØ¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ±...');

            // This is a demo - in real implementation, this would call the research engine
            setTimeout(() => {
                showResponse(`âœ… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«:\n\n` +
                            `ğŸŒ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙˆÙŠØ¨: 5\n` +
                            `ğŸ“š Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©: 3\n` +
                            `ğŸƒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©: Parkour, Rock Climbing, Martial Arts\n\n` +
                            `Ù…ØµØ§Ø¯Ø±:\n` +
                            `- DuckDuckGo API\n` +
                            `- CrossRef Academic Database\n\n` +
                            `Ø§Ù„Ø«Ù‚Ø©: HIGH - Evidence-Based`);
            }, 2000);
        }

        function showResponse(content, isError = false) {
            const card = document.getElementById('responseCard');
            const contentEl = document.getElementById('responseContent');

            card.style.display = 'block';
            contentEl.textContent = content;
            contentEl.style.color = isError ? '#ef4444' : '#374151';

            card.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
